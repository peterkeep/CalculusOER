<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-DerivativeRules" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Some Early Derivative Rules</title>

  <introduction>
    <p>
      We are going to break this topic into two parts:
      <ol>
        <li>
          <p>
            We will try to find some common patterns or connections between derivatives and specific functions. For instance, when we use <xref ref="def-DerivativeFunction" text="type-global-title"/> to build a derivative, are there patterns in the work of evaluating that limit that will allow us to get through the limit work quickly? Can we group some functions together based on how we might deal with the limit?
          </p>
        </li>
        <li>
          <p>
            We will try to think about derivatives a bit more generally and show how we can build some basic properties to help us think about differentiating variations of the functions that we recognize.
          </p>
        </li>
      </ol>
    </p>
  </introduction>
  <subsection xml:id="subsec-DerivativesOfCommonFunctions">
    <title>Derivatives of Common Functions</title>
    <xi:include href="./activities/act-DerivativesOfPowerFunctions.ptx" />
    <p>
      There is a really nice theorem that helps to understand how the <m>(x+\Delta x)^n</m> multiplication goes (for different positive integer exponents, <m>n</m>) called the Binomial Theorem, but we won't introduce it here, fully. What we'll do, instead, is summarize the results:
      <ol>
        <li>
          <p>
            In each term, the exponents on <m>x</m> count down from <m>n</m> to <m>0</m>.
          </p>
        </li>
        <li>
          <p>
            Similarly, in each term, the exponents on <m>\Delta x</m> will count up from <m>0</m> to <m>n</m>.
          </p>
        </li>
        <li>
          <p>
            The coefficients for each term are generated from a very cool pattern, displayed below.
          </p>
        </li>
      </ol>
    </p>
    <figure xml:id="fig-BinomialTriangle-1">
      <caption></caption>
      <image width="80%">
        <shortdescription>Triangle with the binomial coefficients, ending with the row that begins 1, 8, 28, ...</shortdescription>
        <latex-image>
          \begin{tikzpicture}
            % 0th row
            \node [hexagon] at (0,0) {1};
            % 1st row
            \node [hexagon] at (-1/2*0.866,-0.75) {1};
            \node [hexagon] at (1/2*0.866, -0.75) {1};
            % 2nd row 
            \node [hexagon] at (-1*0.866,-1.5) {1};
            \node [hexagon] at (0*0.866, -1.5) {2};
            \node [hexagon] at (1*0.866, -1.5) {1};
            % 3rd row 
            \node [hexagon] at (-3/2*0.866,-2.25) {1};
            \node [hexagon] at (-1/2*0.866,-2.25) {3};
            \node [hexagon] at (1/2*0.866, -2.25) {3};
            \node [hexagon] at (3/2*0.866, -2.25) {1};
            % 4th row 
            \node [hexagon] at (-2*0.866,-3) {1};
            \node [hexagon] at (-1*0.866,-3) {4};
            \node [hexagon] at (0*0.866, -3) {6};
            \node [hexagon] at (1*0.866, -3) {4};
            \node [hexagon] at (2*0.866, -3) {1};
            % 5th row 
            \node [hexagon, fill=DCyellow!40] at (-5/2*0.866,-3.75) {1};
            \node [hexagon, fill=DCyellow!40] at (-3/2*0.866,-3.75) {5};
            \node [hexagon, fill=DCyellow!40] at (-1/2*0.866,-3.75) {10};
            \node [hexagon, fill=DCyellow!40] at (1/2*0.866, -3.75) {10};
            \node [hexagon, fill=DCyellow!40] at (3/2*0.866, -3.75) {5};
            \node [hexagon, fill=DCyellow!40] at (5/2*0.866, -3.75) {1};
            % 6th row 
            \node [hexagon] at (-3*0.866,-4.5) {1};
            \node [hexagon] at (-2*0.866,-4.5) {6};
            \node [hexagon] at (-1*0.866,-4.5) {15};
            \node [hexagon] at (0*0.866, -4.5) {20};
            \node [hexagon] at (1*0.866, -4.5) {15};
            \node [hexagon] at (2*0.866, -4.5) {6};
            \node [hexagon] at (3*0.866, -4.5) {1};
            % 7th row 
            \node [hexagon] at (-7/2*0.866,-5.25) {1};
            \node [hexagon] at (-5/2*0.866,-5.25) {7};
            \node [hexagon] at (-3/2*0.866,-5.25) {21};
            \node [hexagon] at (-1/2*0.866, -5.25) {35};
            \node [hexagon] at (1/2*0.866, -5.25) {35};
            \node [hexagon] at (3/2*0.866, -5.25) {21};
            \node [hexagon] at (5/2*0.866, -5.25) {7};
            \node [hexagon] at (7/2*0.866, -5.25) {1};
            % 8th row 
            \node [hexagon] at (-4*0.866,-6) {1};
            \node [hexagon] at (-3*0.866,-6) {8};
            \node [hexagon] at (-2*0.866,-6) {28};
            \node [hexagon] at (-1*0.866, -6) {56};
            \node [hexagon] at (0*0.866, -6) {70};
            \node [hexagon] at (1*0.866, -6) {56};
            \node [hexagon] at (2*0.866, -6) {28};
            \node [hexagon] at (3*0.866, -6) {8};
            \node [hexagon] at (4*0.866, -6) {1};
          \end{tikzpicture}
        </latex-image>
      </image>
    </figure>
    <p>
      In each row, the coefficients are build by the sum of the two coefficients above it. We have highlighted the 5th row, in order to compare it to the work we did in <xref ref="act-DerivativesOfPowerFunctions"/>.
      <me>
        (x+\Delta x)^5 = x^5+5x^4\Delta x + 10x^3\Delta x^2 + 10x^2\Delta x^3 + 5 x\Delta x^4 + \Delta x^5
      </me>
      We can see the coefficients on each term match the highlighted row!
    </p>
    <figure xml:id="fig-BinomialTriangle-2">
      <caption></caption>
      <image width="80%">
        <shortdescription>Triangle with the binomial coefficients, ending with the row that begins 1, 8, 28, ... In each row, the first term (1) is red. The second number (1, 2, 3, 4, ..., 8) is red. The remaining numbers are blue.</shortdescription>
        <latex-image>
          \begin{tikzpicture}
            % 0th row
            \node [hexagon, fill=DCred!40] at (0,0) {1};
            % 1st row
            \node [hexagon, fill=DCred!40] at (-1/2*0.866,-0.75) {1};
            \node [hexagon, fill=DCgreen!40] at (1/2*0.866, -0.75) {1};
            % 2nd row 
            \node [hexagon, fill=DCred!40] at (-1*0.866,-1.5) {1};
            \node [hexagon, fill=DCgreen!40] at (0*0.866, -1.5) {2};
            \node [hexagon, fill=DCblue!40] at (1*0.866, -1.5) {1};
            % 3rd row 
            \node [hexagon, fill=DCred!40] at (-3/2*0.866,-2.25) {1};
            \node [hexagon, fill=DCgreen!40] at (-1/2*0.866,-2.25) {3};
            \node [hexagon, fill=DCblue!40] at (1/2*0.866, -2.25) {3};
            \node [hexagon, fill=DCblue!40] at (3/2*0.866, -2.25) {1};
            % 4th row 
            \node [hexagon, fill=DCred!40] at (-2*0.866,-3) {1};
            \node [hexagon, fill=DCgreen!40] at (-1*0.866,-3) {4};
            \node [hexagon, fill=DCblue!40] at (0*0.866, -3) {6};
            \node [hexagon, fill=DCblue!40] at (1*0.866, -3) {4};
            \node [hexagon, fill=DCblue!40] at (2*0.866, -3) {1};
            % 5th row 
            \node [hexagon, fill=DCred!40] at (-5/2*0.866,-3.75) {1};
            \node [hexagon, fill=DCgreen!40] at (-3/2*0.866,-3.75) {5};
            \node [hexagon, fill=DCblue!40] at (-1/2*0.866,-3.75) {10};
            \node [hexagon, fill=DCblue!40] at (1/2*0.866, -3.75) {10};
            \node [hexagon, fill=DCblue!40] at (3/2*0.866, -3.75) {5};
            \node [hexagon, fill=DCblue!40] at (5/2*0.866, -3.75) {1};
            % 6th row 
            \node [hexagon, fill=DCred!40] at (-3*0.866,-4.5) {1};
            \node [hexagon, fill=DCgreen!40] at (-2*0.866,-4.5) {6};
            \node [hexagon, fill=DCblue!40] at (-1*0.866,-4.5) {15};
            \node [hexagon, fill=DCblue!40] at (0*0.866, -4.5) {20};
            \node [hexagon, fill=DCblue!40] at (1*0.866, -4.5) {15};
            \node [hexagon, fill=DCblue!40] at (2*0.866, -4.5) {6};
            \node [hexagon, fill=DCblue!40] at (3*0.866, -4.5) {1};
            % 7th row 
            \node [hexagon, fill=DCred!40] at (-7/2*0.866,-5.25) {1};
            \node [hexagon, fill=DCgreen!40] at (-5/2*0.866,-5.25) {7};
            \node [hexagon, fill=DCblue!40] at (-3/2*0.866,-5.25) {21};
            \node [hexagon, fill=DCblue!40] at (-1/2*0.866, -5.25) {35};
            \node [hexagon, fill=DCblue!40] at (1/2*0.866, -5.25) {35};
            \node [hexagon, fill=DCblue!40] at (3/2*0.866, -5.25) {21};
            \node [hexagon, fill=DCblue!40] at (5/2*0.866, -5.25) {7};
            \node [hexagon, fill=DCblue!40] at (7/2*0.866, -5.25) {1};
            % 8th row 
            \node [hexagon, fill=DCred!40] at (-4*0.866,-6) {1};
            \node [hexagon, fill=DCgreen!40] at (-3*0.866,-6) {8};
            \node [hexagon, fill=DCblue!40] at (-2*0.866,-6) {28};
            \node [hexagon, fill=DCblue!40] at (-1*0.866, -6) {56};
            \node [hexagon, fill=DCblue!40] at (0*0.866, -6) {70};
            \node [hexagon, fill=DCblue!40] at (1*0.866, -6) {56};
            \node [hexagon, fill=DCblue!40] at (2*0.866, -6) {28};
            \node [hexagon, fill=DCblue!40] at (3*0.866, -6) {8};
            \node [hexagon, fill=DCblue!40] at (4*0.866, -6) {1};
          \end{tikzpicture}
        </latex-image>
      </image>
    </figure>
    <p>
      We can now think of each row, and figure out what was happening in the limit work we did.
      <ol>
          <li>
              <p>
                  The first term of that multiplication will combine with the subtraction of <m>x^n</m> in the numerator and subtract to 0.
              </p>
              <p>
                We can designate this in the triangle by shading in the first term in red.
              </p>
          </li>
          <li>
              <p>
                  The rest of the terms in the multiplication have at least one copy of <m>\Delta x</m>, and so we can factor out <m>\Delta x</m> and <q>cancel</q> it with the <m>\Delta x</m> in the denominator. 
              </p>
              <p>
                We can designate the terms in the triangle without any remaining <m>\Delta x</m>'s in them by shading the second term in green. The rest, that have at least one <m>\Delta x</m> in it, are shaded in blue.
              </p>
          </li>
          <li>
              <p>
                  Once this has done, we've escaped the portion of the limit that was giving us the <m>\frac{0}{0}</m> indeterminate form, and so we can evaluate the limit as <m>\Delta x\to 0</m>. The result is just that whatever terms still have at least one remaining copy of <m>\Delta x</m> in it <q>go to</q> 0, and we're left with just the terms that do not have any copies of <m>\Delta x</m> in them.
              </p>
              <p>
                Note that all of the blue terms go to <m>0</m> in the limit, and we are left with the green terms, but without any <m>\Delta x</m>. Since these are the second terms, we have the coefficient and one fewer exponent on <m>x</m>.
              </p>
          </li>
      </ol>
    </p>
    <theorem xml:id="thm-PowerRuleDerivatives">
      <title>Power Rule for Derivatives</title>
      <statement>
        <p>
          <me>
            \frac{d}{dx}(x^n) = nx^{n-1}
          </me>
        </p>
      </statement>
    </theorem>
    <p>
      We have shown that this is true for <m>n=2,3,4,...</m>, but this is also true for <em>any</em> value of <m>n</m> (including <m>n=1</m>, non-integers, and non-positives). We will prove this more formally later (in <xref ref="sec-LogarithmicDifferentiation"/>), and until then we will be free to use this result.
    </p>
    <example>
      <introduction>
        <p>
          Let's confirm this Power Rule for two examples that we are familiar with.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
           Find the derivative <m>\frac{d}{dx}\left(\sqrt{x}\right)</m> using the limit definition of the derivative function. Note that <m>\sqrt{x}= x^{1/2}</m> and <m>\frac{1}{2\sqrt{x}} = \frac{1}{2}x^{-1/2}</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
           Find the derivative <m>\frac{d}{dx}\left(\frac{1}{x}\right)</m> using the limit definition of the derivative function. Note that <m>\frac{1}{x}= x^{-1}</m> and <m>-\frac{1}{x^2} = -x^{-2}</m>.
          </p>
        </statement>
      </task>
    </example>
    <p>
      In this activity, we also found one other result.
    </p>
    <theorem xml:id="thm-DerivativeConstant">
      <title>Derivative of a Constant Function</title>
      <statement>
        <p>
          If <m>y=k</m> where <m>k</m> is some real number constant, then <m>y'=0</m>. Another way of saying this is:
          <me>
            \frac{d}{dx}\left(k\right)=0
         </me>.
        </p>
      </statement>
    </theorem>
    
    <xi:include href="./activities/act-TrigDerivatives.ptx" />
    
    <theorem xml:id="thm-TrigDerivatives">
      <title>Derivatives of the Sine and Cosine Functions</title>
      <statement>
        <p>
          <me>
            \dfrac{d}{d\theta}\left(\sin(\theta)\right) = \cos(\theta)
          </me>
          </p>
          <p>
          <me>
            \dfrac{d}{d\theta}\left(\cos(\theta)\right) = -\sin(\theta)
          </me>
        </p>
      </statement>
      <proof>
        <p>
          In order to show why <m>\dfrac{d}{d\theta}\left(\sin(\theta)\right) = \cos(\theta)</m> and <m>\dfrac{d}{dx}\left(\cos(\theta)\right) = -\sin(\theta)</m>, we will work with the limit definitions of both. Consider both:
          <md>
            <mrow>\frac{d}{d\theta}\left(\sin(\theta)\right) \amp = \lim_{\Delta \theta \to 0}\left(\frac{\sin(\theta+\Delta \theta)-\sin(\theta)}{\Delta \theta}\right)</mrow>
            <mrow>\frac{d}{d\theta}\left(\cos(\theta)\right) \amp = \lim_{\Delta \theta \to 0}\left(\frac{\cos(\theta+\Delta \theta)-\cos(\theta)}{\Delta \theta}\right)</mrow>
          </md>
          Our goal is to re-write the numerators in both of these limits as something more usable. So far, we have been evaluating these types of limits (<xref ref="sec-IndeterminateForms" text="title"/>) using some algebraic manipulations. Instead of using algebra, we will use geometry.
        </p>
        <p>
          Consider the unit circle below. We have plotted the angle <m>\theta</m> and are reminded that the point on the circle that corresponds with the terminal side of the angle <m>\theta</m> has coordinates <m>(\cos(\theta),\sin(\theta))</m>. We can label the sides of the triangle pictured below.
        </p>
        <figure xml:id="fig-TrigDerivative-1">
          <caption>Unit circle with the angle <m>\theta</m>.</caption>
          <image source="./Derivatives/TrigDerivative-1.png" width="70%">
            <shortdescription>A unit circle, with an angle theta placed in the first quadrant. A triangle is formed using the angle, where the hypotenuse is the radius of the circle (1) the height is sin(theta) and the base is cos(theta).</shortdescription>
          </image>
        </figure>
        <p>
          Now we consider a second point on the circle, this one formed by the terminal side of the angle <m>(\theta+\Delta \theta)</m>. This point has coordinates <m>(\cos(\theta+\Delta \theta), \sin(\theta+\Delta \theta))</m>. Note, below, that we want to find expressions for <m>\sin(\theta+\Delta\theta)-\sin(\theta)</m> and <m>\cos(\theta+\Delta\theta) - \cos(\theta)</m>. We can find these geometrically.
        </p>
        <figure xml:id="fig-TrigDerivative-2">
          <caption>Angles <m>\theta</m> and <m>\theta+\Delta\theta</m>.</caption>
          <image source="./Derivatives/TrigDerivative-2.png" width="70%">
            <shortdescription>A triangle on a unit circle, with standard lengths 1, sin(theta), and cos(theta). Another point is labeled on the unit circle. There is a triangle formed by the line connecting the two points, and then the vertical and horizontal components of the distance between the two points. The vertical distance is labeled sin(theta+Delta theta)-sin(theta) and the horizontal distance is labeled cos(theta)-cos(theta+Delta theta). The hypotenuse is labeled h, but it is very close to the same as the arclength between the two points, labeled Delta theta.</shortdescription>
          </image>
        </figure>
        <p>
          Note, then, that the two triangles look to be similar triangles. We can say, then, that:
          <md>
            <mrow>\sin(\theta+\Delta\theta)-\sin(\theta)\amp \approx h\cos(\theta) </mrow>
            <mrow>\cos(\theta)-\cos(\theta+\Delta\theta)\amp \approx h\sin(\theta) </mrow>
          </md>
          In fact, we will find that in the limit as <m>\Delta \theta\to 0</m>, the length <m>h</m> matches the arc length <m>\Delta \theta</m> perfectly, and thus lays at a right angle to the terminal side of the angle <m>\theta+\Delta \theta</m>. Since as <m>\Delta \theta\to 0</m> we have <m>h\to\Delta \theta</m>, we can say:
          <md>
            <mrow> (\sin(\theta+\Delta\theta)-\sin(\theta))\amp\to \Delta \theta \cos(\theta)</mrow>
            <mrow> (\cos(\theta)-\cos(\theta+\Delta\theta))\amp\to \Delta \theta \sin(\theta)</mrow>
          </md>
        </p>
        <p>
          Consider, then, the limits involved in the derivative calculations that we built earlier.
          <md>
            <mrow>\frac{d}{d\theta}\left(\sin(\theta)\right) \amp = \lim_{\Delta \theta\to 0}\left(\frac{\sin(\theta+\Delta \theta)-\sin(\theta)}{\Delta \theta}\right)</mrow>
            <mrow> \amp =\lim_{\Delta \theta \to 0} \left(\frac{\Delta \theta \cos(\theta)}{\Delta \theta}\right)</mrow>
            <mrow> \amp = \lim_{\Delta \theta \to 0} (\cos (\theta))</mrow>
            <mrow> \amp = \cos(\theta)</mrow>
            <mrow>\frac{d}{d\theta}\left(\cos(\theta)\right) \amp = \lim_{\Delta \theta \to 0}\left(\frac{\cos(\theta+\Delta \theta)-\cos(\theta)}{\Delta \theta}\right)</mrow>
            <mrow> \amp = \lim_{\Delta \theta \to 0}\left(\frac{-(\cos(\theta)-\cos(\theta+\Delta \theta)) }{\Delta \theta}\right)</mrow>
            <mrow> \amp = \lim_{\Delta \theta \to 0}\left(\frac{-\Delta \sin(\theta)}{\Delta \theta}\right)</mrow>
            <mrow> \amp = \lim_{\Delta \theta \to 0} (-\sin(\theta))</mrow>
            <mrow> \amp = -\sin(\theta)</mrow>
          </md>
        </p>
        <p>
          So we have shown that <m>\dfrac{d}{d\theta}(\sin(\theta)) = \cos(\theta)</m> and <m>\dfrac{d}{d\theta}(\cos(\theta)) = -\sin(\theta)</m> as we claimed.
        </p>
      </proof>
    </theorem>
    <xi:include href="./activities/act-ExponentialDerivatives.ptx" />
    <theorem xml:id="thm-ExponentialDerivative">
      <title>Derivative of the Exponential Function</title>
      <statement>
        <p>
          <me>
            \frac{d}{dx}\left(e^x\right) = e^x
          </me>
        </p>
      </statement>
    </theorem>
    
  </subsection>

  <subsection xml:id="subsec-DerivativeProperties">
    <title>Some Properties of Derivatives in General</title>
    <theorem xml:id="thm-CombinationsOfDerivatives">
      <title>Combinations of Derivatives</title>
      <statement>
        <p>
          If <m>f(x)</m> and <m>g(x)</m> are differentiable functions, then the following statements about their derivatives are true.
          <ol>
            <li>
              <p>
                <em>Sums:</em> The derivative of the sum of <m>f(x)</m> and <m>g(x)</m> is the sum of the derivatives of <m>f(x)</m> and <m>g(x)</m>:

                <md>
                  <mrow>  \frac{d}{dx} \left(f(x) + g(x)\right) \amp  = \left(\frac{d}{dx} f(x)\right) + \left(\frac{d}{dx} g(x)\right)</mrow>
                  <mrow> \amp = f'(x) + g'(x)</mrow>
                </md>
              </p>
            </li>
            <li>
              <p>
                <em>Differences:</em> The derivative of the difference of <m>f(x)</m> and <m>g(x)</m> is the difference of the derivatives of <m>f(x)</m> and <m>g(x)</m>:

                <md>
                  <mrow>  \frac{d}{dx} \left(f(x) - g(x)\right) \amp  = \left(\frac{d}{dx} f(x)\right) - \left(\frac{d}{dx} g(x)\right)</mrow>
                  <mrow> \amp = f'(x) - g'(x)</mrow>
                </md>
              </p>
            </li>
            <li>
              <p>
                <em>Coefficients:</em> If <m>k</m> is some real number coefficient, then:
                 <md>
                  <mrow>  \frac{d}{dx} \left(kf(x)\right) \amp  = k\left(\frac{d}{dx} f(x)\right) </mrow>
                  <mrow> \amp = kf'(x)</mrow>
                </md>
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </theorem>
    <p>
      We can think about each of these properties through the lense of how combining these functions impacts the slopes. For instance, if we wanted to visualize the property about coefficients (that <m>\ddx{kf(x)}=k\ddx{f(x)}</m>), we can visualize this coefficient as a scaling factor.
    </p>
    <interactive platform="doenetml" width="90%" aspect="1:1.1">
        <slate surface="doenetml">
            <xi:include parse="text" href="./doenet/ScaledDerivatives.xml"/>
        </slate>
    </interactive>
    <example>
      <title>Putting These Together</title>
      <introduction>
        <p>
          Find the following derivatives:
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            <m>\displaystyle \ddx{4x^5 - \dfrac{5x}{2}+6\cos(x)-1}</m>
          </p>
        </statement>
        <solution>
          <p>
            <md>
              <mrow> \ddx{4x^5 - \dfrac{5x}{2}+6\cos(x)-1}\amp = \ddx{4x^5} - \ddx{\dfrac{5x}{2}} + \ddx{6\cos(x)} - \ddx{1} </mrow>
              <mrow> \amp =4\ddx{x^5} - \dfrac{5}{2}\ddx{x} + 6\ddx{\cos(x)} - \ddx{1}</mrow>         
              <mrow> \amp =4(5x^4) - \dfrac{5}{2}(1) + 6(-\sin(x)) - 0</mrow>
              <mrow> \amp =20x^4 - \dfrac{5}{2} - 6\sin(x)</mrow>
            </md>
          </p>
        </solution>
      </task>
    </example>
  </subsection> 
  <xi:include href="./exercises/ex-DerivativeRules.ptx" />
</section>